---
title: Overview
banner:
  content: |
    Have an Open SaaS app in production? <a href="https://e44cy1h4s0q.typeform.com/to/EPJCwsMi">We'll send you some swag! ðŸ‘•</a>
---

This guide will show you how to set up Payments for testing and local development with the following payment processors:
- Stripe
- Lemon Squeezy
- Polar

:::note[Which should I choose?]
Stripe is the industry standard, is more configurable, and has cheaper fees.
Lemon Squeezy acts a [Merchant of Record](https://www.lemonsqueezy.com/reporting/merchant-of-record). This means they take care of paying taxes in multiple countries for you, but charge higher fees per transaction.
Polar is an open-source [Merchant of Record](https://docs.polar.sh/merchant-of-record/introduction#merchant-of-record) designed specifically for developers.
:::

## Important First Steps

First, go to `/src/payment/paymentProcessor.ts` and choose which payment processor you'd like to use: Stripe, Lemon Squeezy, or Polar:

```ts title="src/payment/paymentProcessor.ts" ins={6, 8, 10}
import { stripePaymentProcessor } from './stripe/paymentProcessor';
import { lemonSqueezyPaymentProcessor } from './lemonSqueezy/paymentProcessor';
import { polarPaymentProcessor } from './polar/paymentProcessor';
//...

export const paymentProcessor: PaymentProcessor = stripePaymentProcessor;
// or... 
export const paymentProcessor: PaymentProcessor = lemonSqueezyPaymentProcessor;
// or...
export const paymentProcessor: PaymentProcessor = polarPaymentProcessor;
```

At this point, you can delete:
- The unused payment processor code within the `/src/payment/<unused-provider>` directory.
- Any unused environment variables from `.env.server` (they will be prefixed with the name of the provider your are not using):
  - E.g. `STRIPE_API_KEY`, `LEMONSQUEEZY_API_KEY`, `POLAR_ORGANIZATION_ACCESS_TOKEN`.
- Make sure to also uninstall the unused dependencies:
  - If using Stripe:
    ```sh
    npm uninstall @lemonsqueezy/lemonsqueezy.js @polar-sh/sdk
    ```
  - If using Lemon Squeezy:
    ```sh
    npm uninstall stripe @polar-sh/sdk
    ```
  - If using Polar:
    ```sh
    npm uninstall @lemonsqueezy/lemonsqueezy.js stripe
    ```
- Remove any unused fields from the `User` model in the `schema.prisma` file if they exist:
  - E.g. `lemonSqueezyCustomerPortalUrl`.

Now your code is ready to go with your preferred payment processor and it's time to configure your payment processor's API keys, products, and other settings.

Follow the steps for your selected processor:

- [Stripe](stripe/)
- [Lemon Squeezy](lemon-squeezy/)
- [Polar](polar/)

## Deploying

Once you deploy your app, you can follow the same steps, just make sure that you are no longer in test/sandbox mode within the payment processor dashboard. After you've repeated the steps in live mode, add the new API keys and price/variant IDs to your environment variables in your deployed environment.
