---
title: Overview
banner:
  content: |
    Have an Open SaaS app in production? <a href="https://e44cy1h4s0q.typeform.com/to/EPJCwsMi">We'll send you some swag! ðŸ‘•</a>
---
import { TabItem, Tabs } from '@astrojs/starlight/components';

This guide will show you how to set up payments for testing and local development with the following payment processors:
- Stripe
- Lemon Squeezy
- Polar

:::note[Which should I choose?]
Stripe is the industry standard, is more configurable, and has cheaper fees.
Lemon Squeezy acts a [Merchant of Record](https://www.lemonsqueezy.com/reporting/merchant-of-record). This means they take care of paying taxes in multiple countries for you, but charge higher fees per transaction.
Polar is an open-source [Merchant of Record](https://docs.polar.sh/merchant-of-record/introduction#merchant-of-record) designed specifically for developers.
:::

## Important First Steps

First, go to `/src/payment/paymentProcessor.ts` and choose which payment processor you'd like to use:

<Tabs syncKey="payment-provider">
  <TabItem label="Stripe">
    ```ts title="src/payment/paymentProcessor.ts" del={6, 7}
    import { stripePaymentProcessor } from './stripe/paymentProcessor';
    
    // ...

    export const paymentProcessor: PaymentProcessor = stripePaymentProcessor;
    // export const paymentProcessor: PaymentProcessor = lemonSqueezyPaymentProcessor;
    // export const paymentProcessor: PaymentProcessor = polarPaymentProcessor;
    ```
  </TabItem>
  <TabItem label="Lemon Squeezy">
    ```ts title="src/payment/paymentProcessor.ts" del={1, 6, 7, 8} ins={2, 9}
    import { stripePaymentProcessor } from './stripe/paymentProcessor';
    import { lemonSqueezyPaymentProcessor } from './lemonSqueezy/paymentProcessor';
    
    // ...

    export const paymentProcessor: PaymentProcessor = stripePaymentProcessor;
    // export const paymentProcessor: PaymentProcessor = lemonSqueezyPaymentProcessor;
    // export const paymentProcessor: PaymentProcessor = polarPaymentProcessor;
    export const paymentProcessor: PaymentProcessor = lemonSqueezyPaymentProcessor;
    ```
  </TabItem>
  <TabItem label="Polar">
     ```ts title="src/payment/paymentProcessor.ts" del={1, 6, 7, 8} ins={2, 9}
    import { stripePaymentProcessor } from './stripe/paymentProcessor';
    import { polarPaymentProcessor } from './polar/paymentProcessor';
    
    // ...

    export const paymentProcessor: PaymentProcessor = stripePaymentProcessor;
    // export const paymentProcessor: PaymentProcessor = lemonSqueezyPaymentProcessor;
    // export const paymentProcessor: PaymentProcessor = polarPaymentProcessor;
    export const paymentProcessor: PaymentProcessor = polarPaymentProcessor;
    ```
</TabItem>
</Tabs>

Then you should delete:
- The unused payment processor code within the `/src/payment/<unused-provider>` directories.
- Any unused environment variables from `.env.server` (they will be prefixed with the name of the provider your are not using):
  - E.g. `STRIPE_API_KEY`, `LEMONSQUEEZY_API_KEY`, `POLAR_ORGANIZATION_ACCESS_TOKEN`.
- Make sure to also uninstall the unused dependencies:
  <Tabs syncKey="payment-provider">
    <TabItem label="Stripe">
      ```sh
      npm uninstall @lemonsqueezy/lemonsqueezy.js @polar-sh/sdk
      ```
    </TabItem>
    <TabItem label="Lemon Squeezy">
      ```sh
      npm uninstall stripe @polar-sh/sdk
      ```
    </TabItem>
    <TabItem label="Polar">
      ```sh
      npm uninstall @lemonsqueezy/lemonsqueezy.js stripe
      ```
  </TabItem>
  </Tabs>
- Remove any unused fields from the `User` model in the `schema.prisma` file if they exist:
  - E.g. `lemonSqueezyCustomerPortalUrl`.

Now your code is ready to go with your preferred payment processor and it's time to configure your payment processor's API keys, products, and other settings.

Follow the steps for your selected processor:

- [Stripe](stripe/)
- [Lemon Squeezy](lemon-squeezy/)
- [Polar](polar/)


## Deploying

Once you're ready to deploy your app, follow the steps from the [deploying guide](/guides/deploying/) to set up the production settings for your prayment provider.
